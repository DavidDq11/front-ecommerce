<section class="w-full px-4 md:px-6 lg:px-8">
  <!-- Carousel -->
  <div class="flex justify-center">
    <app-carousel 
      [slideImages]="images" 
      [customHeight]="'h-[150px] sm:h-[200px] md:h-[250px] lg:h-[300px]'"
      [customWidth]="'w-full sm:w-[90%] md:w-[85%] lg:w-[80%]'">
    </app-carousel>
  </div>

  <!-- Categories Section -->
  <div class="categories-section py-8 bg-gradient-to-b from-gray-50 to-white">
    <h3 class="text-center font-extrabold text-gray-900 tracking-wide 
          text-2xl sm:text-3xl md:text-4xl lg:text-5xl 
          bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent">
      Explora nuestras <span class="text-orange-600">Categorías</span>
    </h3>

    <div class="categories-container flex justify-center flex-wrap gap-6 px-4 max-w-7xl mx-auto categories">
      <a
        *ngFor="let category of categories"
        [routerLink]="category.path"
        (click)="selectCategory(category.id)"
        class="category-item flex flex-col items-center text-center hover:text-purple-600 transition-all duration-300 category-card"
      >
        <div class="icon-wrapper w-20 h-20 sm:w-24 sm:h-24 bg-gradient-to-br from-white to-gray-200 rounded-full flex items-center justify-center shadow-md hover:shadow-lg transform hover:-translate-y-2 transition-transform duration-200">
          <i class="fas {{ category.icon }} text-3xl sm:text-4xl text-orange-600 hover:text-purple-600 transition-colors duration-200"></i>
        </div>
        <span class="mt-3 text-sm sm:text-base font-medium">{{ category.name }}</span>
      </a>
    </div>
  </div>

  <!-- Brands Section -->
  <div class="brands-section py-8 bg-gradient-to-b from-white to-gray-50">
    <h3 class="text-center font-bold text-gray-900 tracking-wide 
          text-xl sm:text-2xl md:text-3xl lg:text-4xl 
          bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent text-shadow-sm">
      Marcas <span class="text-orange-600">Destacadas</span>
    </h3>
    <div class="relative max-w-7xl mx-auto px-4">
      <div class="brands-container flex overflow-x-auto scrollbar-hide snap-x snap-mandatory">
        <div *ngFor="let brand of brands" 
             class="brand-item flex flex-col items-center text-center cursor-pointer flex-none snap-center"
             [ngClass]="{'brand-selected': selectedBrandId === brand.id}"
             (click)="selectBrand(brand.id, brand.name)">
          <div class="brand-wrapper w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 bg-gradient-to-br from-white to-gray-200 rounded-full flex items-center justify-center shadow-md hover:shadow-lg transform hover:-translate-y-2 transition-all duration-300">
            <img *ngIf="brand.image" 
                 [src]="brand.image" 
                 [alt]="brand.name" 
                 class="w-full h-full object-contain rounded-full p-2"
                 (error)="onBrandImageError($event)" />
            <span *ngIf="!brand.image" 
                  class="text-sm sm:text-base font-medium text-gray-700">
              {{ brand.name | slice:0:2 | uppercase }}
            </span>
          </div>
          <span class="mt-3 text-sm sm:text-base font-medium">{{ brand.name }}</span>
        </div>
      </div>
      <!-- Navigation Buttons -->
      <button class="brand-nav-button left-0" (click)="scrollBrands('left')">
        <i class="fas fa-chevron-left text-xl text-gray-600 hover:text-purple-600"></i>
      </button>
      <button class="brand-nav-button right-0" (click)="scrollBrands('right')">
        <i class="fas fa-chevron-right text-xl text-gray-600 hover:text-purple-600"></i>
      </button>
    </div>
  </div>

  <!-- About Us Section -->
  <section class="py-10 bg-gray-50 about-us-section">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <h3 class="text-2xl sm:text-3xl md:text-4xl font-extrabold text-gray-800 text-center mb-8 
                 bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent">
        Domipets: Tu aliado para tus mascotas
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Historia -->
        <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 text-center">
          <i class="fa-solid fa-paw text-orange-600 text-3xl mb-4"></i>
          <h4 class="text-lg font-semibold text-gray-800 mb-2">Quiénes Somos</h4>
          <p class="text-gray-600 text-sm leading-relaxed">
            Somos Domipets, una tienda local de Manizales y Villa María que lleva productos de calidad para tus mascotas directamente a tu puerta.
          </p>
        </div>
        <!-- Compromiso de Entrega -->
        <div class="bg-teal-500 p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 text-center text-white">
          <i class="fa-solid fa-truck-fast text-white text-3xl mb-4"></i>
          <h4 class="text-lg font-semibold mb-2">Compromiso de Entrega</h4>
          <p class="text-sm leading-relaxed">
            Pide antes de las 3 p.m. y recibe el mismo día en Manizales y Villa María. Después de las 3 p.m., entregamos a primera hora del día siguiente.
          </p>
        </div>
        <!-- Llamado a la Acción -->
        <div class="bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 text-center flex flex-col justify-center">
          <i class="fa-solid fa-heart text-orange-600 text-3xl mb-4"></i>
          <h4 class="text-lg font-semibold text-gray-800 mb-2">Únete a Domipets</h4>
          <p class="text-gray-600 text-sm leading-relaxed mb-4">
            Descubre por qué somos la elección de los amantes de las mascotas.
          </p>
          <a [routerLink]="['/about']" class="inline-block px-6 py-3 bg-teal-500 text-white rounded-lg hover:bg-teal-600 transition-all duration-200">
            Conoce más
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- New Arrivals Section -->
  <article class="my-5 md:my-8">
    <div class="flex items-center justify-center gap-3 mb-6">
      <i class="fa-solid fa-paw text-orange-600 text-3xl"></i>
      <h3 class="text-2xl sm:text-3xl font-bold text-gray-800">Nuevos Productos</h3>
      <i class="fa-solid fa-bone text-orange-600 text-3xl"></i>
    </div>

    <!-- Error State -->
    <div class="flex justify-center items-center h-[50vh] sm:h-[60vh]" *ngIf="error && isLoading">
      <div class="text-red-500 flex flex-col justify-center items-center">
        <i class="fa-solid fa-circle-exclamation text-4xl sm:text-6xl"></i>
        <h4 class="text-sm sm:text-md px-4 py-2">HTTP ERROR Occurred</h4>
      </div>
    </div>

    <!-- Loading Skeleton -->
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4 sm:gap-5" *ngIf="!error && isLoading">
      <app-cardskeleton *ngFor="let skeleton of skeletons"></app-cardskeleton>
    </div>

    <!-- Product Grid -->
    <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 sm:gap-5" *ngIf="!isLoading && products.length > 0">
      <div *ngFor="let product of products" 
          class="relative flex flex-col h-full bg-white hover:border border-gray-300 rounded-lg shadow-sm overflow-hidden">
        <!-- Product Image -->
        <a [routerLink]="['/categories', 'product', product.id]" class="w-full h-32 sm:h-40 md:h-48 overflow-hidden">
          <img 
            class="w-full h-full object-contain sm:object-cover transition-all duration-500 hover:scale-110"
            [src]="product.images && product.images.length > 0 ? product.images[0].image_url : 'assets/placeholder.jpg'"
            [alt]="product.title" 
            (error)="onImageError($event)" />
        </a>

        <!-- Product Details -->
        <div class="flex flex-col justify-between flex-grow p-3 sm:p-4 w-full">
          <div> <!-- Contenedor para los detalles del producto -->
            <a [routerLink]="['/categories', 'product', product.id]">
              <h5 class="mb-1 sm:mb-2 text-sm sm:text-base tracking-tight text-gray-900 line-clamp-2" *ngIf="product?.title">
                {{ product.title }}
              </h5>
            </a>
            <p class="text-xs sm:text-sm text-gray-700">
              <span class="font-bold mr-2">{{ product.price | currency:'COP':'symbol':'1.0-0' }}</span>
              <span *ngIf="product.prevprice" class="line-through mr-2 text-gray-500">{{ product.prevprice | currency:'COP':'symbol':'1.0-0' }}</span>
            </p>
          </div>

          <!-- Selector de tamaños -->
          <div class="flex flex-wrap gap-2 mb-2" *ngIf="product.sizes && product.sizes.length > 0">
            <button
              *ngFor="let size of product.sizes"
              [ngClass]="product.size === size.size ? 'h-10 px-3 bg-teal-500 text-white rounded-lg' : 'h-10 px-3 border border-teal-500 text-teal-500 hover:bg-teal-500 hover:text-white rounded-lg transition-all duration-200'"
              (click)="selectSize(product, size)"
              [disabled]="size.stock_quantity === 0"
            >
              {{ size.size }}
            </button>
          </div>

          <!-- Botón de Agregar o Eliminar del Carrito -->
          <div class="mt-auto"> <!-- Esto empuja el botón hacia abajo -->
            <ng-container *ngIf="product.stock === 'In stock'">
              <button
                class="px-2 py-1 bg-gray-800 text-gray-200 text-xs sm:text-sm w-full rounded"
                *ngIf="!isProductInCart(product)"
                (click)="addToCart(product)"
                [disabled]="product.sizes && product.sizes.length > 0 && !product.size">
                <i class="fa-solid fa-bag-shopping mr-1"></i> Agregar al carrito
              </button>

              <button
                class="px-2 py-1 bg-red-700 text-gray-200 text-xs sm:text-sm w-full rounded"
                *ngIf="isProductInCart(product)"
                (click)="removeFromCart(product)">
                <i class="fa-solid fa-trash mr-1"></i> Eliminar del carrito
              </button>
            </ng-container>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="text-center text-gray-500 py-8" *ngIf="!isLoading && products.length === 0">
      <p>No products available at the moment.</p>
    </div>
  </article>

  <!-- News Section -->
  <article class="my-8 bg-gradient-to-b from-orange-100 to-white p-6 rounded-lg shadow-md">
    <div class="flex items-center justify-center gap-3 mb-6">
      <i class="fa-solid fa-newspaper text-orange-600 text-3xl"></i>
      <h3 class="text-2xl sm:text-3xl font-bold text-gray-800">Noticias Importantes</h3>
      <i class="fa-solid fa-paw text-orange-600 text-3xl"></i>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <div *ngFor="let news of newsItems" class="bg-white p-4 rounded-lg shadow-sm hover:shadow-lg transition-shadow duration-300">
        <h4 class="text-lg font-semibold text-gray-900 mb-2">{{ news.title }}</h4>
        <p class="text-sm text-gray-600 mb-4">{{ news.summary }}</p>
        <a href="{{ news.link }}" target="_blank" class="text-orange-600 hover:text-purple-600 text-sm font-medium">Leer más</a>
      </div>
    </div>
  </article>
</section>