<div class="container mx-auto px-4 py-10 max-w-4xl bg-gray-50 min-h-screen">
  <h2 class="text-4xl font-extrabold text-gray-900 mb-8 text-center">Finalizar tu Compra</h2>
  <form [formGroup]="checkoutForm" (ngSubmit)="submitOrder()" class="space-y-8">
    <!-- Shipping Address -->
    <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
      <h3 class="text-2xl font-semibold text-gray-800 mb-5">Dirección de Envío</h3>
      <div formGroupName="shippingAddress" class="grid grid-cols-1 sm:grid-cols-2 gap-5">
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Nombre *</label>
          <input formControlName="firstName" placeholder="Ej: Juan" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900 placeholder-gray-400" />
          <div *ngIf="checkoutForm.get('shippingAddress.firstName')?.touched && checkoutForm.get('shippingAddress.firstName')?.invalid" class="text-red-600 text-xs mt-1">Por favor, ingresa tu nombre</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Apellido *</label>
          <input formControlName="lastName" placeholder="Ej: Pérez" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900 placeholder-gray-400" />
          <div *ngIf="checkoutForm.get('shippingAddress.lastName')?.touched && checkoutForm.get('shippingAddress.lastName')?.invalid" class="text-red-600 text-xs mt-1">Por favor, ingresa tu apellido</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico *</label>
          <input formControlName="email" placeholder="Ej: juan@correo.com" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900 placeholder-gray-400" />
          <div *ngIf="checkoutForm.get('shippingAddress.email')?.touched && checkoutForm.get('shippingAddress.email')?.invalid" class="text-red-600 text-xs mt-1">Ingresa un correo válido</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Teléfono *</label>
          <input formControlName="mobile" placeholder="Ej: +57 300 123 4567" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900 placeholder-gray-400" />
          <div *ngIf="checkoutForm.get('shippingAddress.mobile')?.touched && checkoutForm.get('shippingAddress.mobile')?.invalid" class="text-red-600 text-xs mt-1">Ingresa un teléfono válido</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Calle *</label>
          <input formControlName="address" placeholder="Ej: Carrera 23 #45-67" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900 placeholder-gray-400" />
          <div *ngIf="checkoutForm.get('shippingAddress.address')?.touched && checkoutForm.get('shippingAddress.address')?.invalid" class="text-red-600 text-xs mt-1">Ingresa una dirección válida</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Ciudad *</label>
          <select formControlName="city" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900">
            <option value="Manizales">Manizales</option>
            <option value="Villa María">Villa María</option>
          </select>
          <div *ngIf="checkoutForm.get('shippingAddress.city')?.touched && checkoutForm.get('shippingAddress.city')?.invalid" class="text-red-600 text-xs mt-1">Selecciona una ciudad</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">Departamento *</label>
          <input formControlName="state" value="Caldas" readonly class="w-full p-3.5 border border-gray-200 rounded-lg bg-gray-100 text-gray-900 cursor-not-allowed" />
          <div *ngIf="checkoutForm.get('shippingAddress.state')?.touched && checkoutForm.get('shippingAddress.state')?.invalid" class="text-red-600 text-xs mt-1">Ingresa un departamento</div>
        </div>
        <div class="relative">
          <label class="block text-sm font-medium text-gray-700 mb-1">País</label>
          <input formControlName="country" value="Colombia" readonly class="w-full p-3.5 border border-gray-200 rounded-lg bg-gray-100 text-gray-900 cursor-not-allowed" />
        </div>
      </div>
    </div>

    <!-- Billing Address -->

    <!-- Payment Method -->
    <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
      <h3 class="text-2xl font-semibold text-gray-800 mb-5">Método de Pago</h3>
      <select formControlName="paymentMethod" class="w-full p-3.5 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-gray-50 text-gray-900">
        <option value="credit_card">Tarjeta de Crédito</option>
        <option value="paypal">PayPal</option>
        <option value="cash_on_delivery">Contraentrega</option>
      </select>
      <div *ngIf="checkoutForm.get('paymentMethod')?.touched && checkoutForm.get('paymentMethod')?.invalid" class="text-red-600 text-xs mt-1">Selecciona un método de pago</div>
    </div>

    <!-- Cart Summary -->
    <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
      <h3 class="text-2xl font-semibold text-gray-800 mb-5">Resumen del Carrito</h3>
      <div *ngFor="let item of cart" class="flex items-center justify-between py-4 border-b border-gray-100">
        <div class="flex items-center space-x-4">
          <img
            [src]="item.images && item.images[0]?.image_url || item.sizes[0]?.image_url || 'https://via.placeholder.com/80'"
            [alt]="item.title"
            class="w-20 h-20 object-cover rounded-lg border border-gray-200"
          />
          <div>
            <span class="font-semibold text-gray-900">{{ item.title }}</span>
            <p class="text-sm text-gray-600">{{ item.size || 'Sin tamaño' }} | {{ item.qty }} unidad{{ item.qty > 1 ? 'es' : '' }}</p>
          </div>
        </div>
        <span class="font-semibold text-gray-900">{{ item.totalprice | currency:'COP':'symbol':'1.0-0' }}</span>
      </div>
      <div class="flex justify-between items-center mt-4">
        <span class="text-xl font-semibold text-gray-900">Domicilio:</span>
        <span class="text-xl font-semibold text-gray-900">{{ 6000 | currency:'COP':'symbol':'1.0-0' }}</span>
      </div>
      <div class="flex justify-between items-center mt-6 pt-4 border-t border-gray-200">
        <span class="text-xl font-semibold text-gray-900">Total:</span>
        <span class="text-xl font-semibold text-gray-900">{{ estimatedTotal | currency:'COP':'symbol':'1.0-0' }}</span>
      </div>
    </div>

    <!-- Submit Button -->
    <button
      type="submit"
      class="w-full bg-indigo-600 text-white py-3.5 px-6 rounded-lg hover:bg-indigo-700 focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-all duration-200 font-semibold text-lg disabled:bg-gray-300 disabled:cursor-not-allowed"
      [disabled]="checkoutForm.invalid"
    >
      Confirmar Pedido
    </button>
  </form>
</div>